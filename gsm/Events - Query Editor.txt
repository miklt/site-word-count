https://docs.blockbit.com/display/RC/Events+-+Query+Editor
1201
['', 'Events - Query Editor', '']
['', 'Através do editor de queries, é possível criar, editar e salvar uma queries\xa0para efetuar uma busca aprofundada nos eventos, ao clicar no\xa0Query Editor\xa0[] a seguinte janela será exibida:Events - Query EditorA seguir analisaremos cada campo desta janela:Events - Query Editor - Create queryNa aba "Create query" é possível configurar como a query irá atuar:Events - Query Editor - Create queryNew query:\xa0Determina qual será o nome da query. Ex.: Last 7 days;Date range:\xa0Permite determinar um período para filtrar os resultados de forma mais precisa, as opções possíveis são:By date:\xa0Determina uma data específica;By period:\xa0Exibe resultados de uma data inicial (“Start date”) até uma data final (“End date”);Today:\xa0Exibe resultados especificamente para a data de hoje;Yesterday:\xa0Exibe resultados especificamente para ontem;Last 7 days:\xa0Filtra especificamente os resultados dos últimos 7 dias;Last 30 days:\xa0Filtra especificamente os resultados dos últimos 30 dias;This month:\xa0Exibe os resultados deste mês;Last month:\xa0Exibe os resultados do último mês.Filter:\xa0Esta campo permite selecionar o tipo de filtro que será utilizado pela query\xa0para selecionar os resultados que serão exibidos. As opções possíveis são:logtype:\xa0Faz a seleção pelo\xa0tipo de\xa0log,\xa0para este filtro as\xa0opções disponíveis são:\xa0webfilter, firewall, dpi, ips, atp;src:\xa0Efetua a seleção pelo\xa0IP\xa0de origem,\xa0este filtro aceita endereços IPv4 ou Ipv6 como valor. Ex.: 172.16.12.171;dst:\xa0Faz a seleção pelo\xa0IP de destino, este filtro aceita endereços IPv4 ou Ipv6 como valor. Ex.: 172.16.12.171;sport:\xa0Este filtro possibilita a seleção por uma\xa0porta de origem. Ex.: 1 a 65535;dport:\xa0Este filtro possibilita a seleção por uma\xa0porta de destino. Ex.: 1 a 65535;protocol:\xa0Este filtro permite a\xa0seleção por protocolo,\xa0as opções disponíveis são: tcp, udp, icmp, ip;service:\xa0No caso deste filtro, é feita a seleção por serviço, os valores aceitos são baseados na tabela do IANA, para mais informações consulte esta página;devin:\xa0Faz a seleção pelo Device de entrada, este filtro aceita interfaces, para mais informações sobre como criá-las, consulte esta página. Ex.: eth0, eth1, eth2, etc;devout:\xa0No caso deste filtro, a\xa0seleção é feita pelo Device de saída, os valores aceitos são as\xa0interfaces criadas pelo usuário,\xa0para mais informações sobre como criá-las, consulte esta página. Ex.: eth0, eth1, eth2, etc;zonein:\xa0Este filtro possibilita a\xa0seleção pela zona de entrada, os valores aceitos são as zonas configuradas nas\xa0interfaces do UTM, para mais informações consulte esta página. Ex.: LAN, WAN, DMZ, etc;zoneout:\xa0Este filtro possibilita a\xa0seleção pela zona de saída, os valores aceitos são as zonas configuradas nas\xa0interfaces do UTM,\xa0para mais informações consulte esta página. Ex.: LAN, WAN, DMZ, etc;client_mac:\xa0Faz a\xa0seleção por endereço MAC, portanto,\xa0este filtro aceita endereços físicos. Ex.: 84:d5:f7:57:5b:db;client_user:\xa0Este filtro efetua a\xa0seleção por usuário, ele aceita e-mails como valores. Ex.: user@blockbit.com;client_ip:\xa0Este filtro efetua a\xa0seleção pelo IP do cliente, os valores aceitos são endereços IPv4 ou Ipv6. Ex.: 172.16.9.153;geoip_src:\xa0No caso deste filtro, a seleção é feita\xa0pela origem do GeoIP (Geolocalização de endereço IP), os valores aceitos são siglas de país. Ex.: BR, US, CA, CN, etc;geoip_dst:\xa0Efetua a\xa0seleção pelo destino do GeoIP (Geolocalização de endereço IP), os valores aceitos são siglas de país. Ex.: BR, US, CA, CN, etc;rule_name:\xa0Este filtro efetua\xa0seleções pelo nome da regra, sendo que o nome das regras criadas no UTM são utilizadas como valor, para mais informações consulte esta página;rule_action:\xa0Faz a\xa0seleção baseada na ação que a regra toma, este filtro aceita como valor as opções: Allow, Alert\xa0ou Deny. Ex.: Deny;web_category:\xa0Este filtro possibilita a\xa0seleção\xa0por categoria\xa0web, sendo estas mesmas aceitas como valor. Ex.:\xa0Information Technology,\xa0Web Mail,\xa0Personal Network Storage and Backup, etc.web_site:\xa0Faz a\xa0seleção por sites, este filtro aceita URLs como valor. Ex.: https://www.blockbit.com;web_method:\xa0Efetua a seleção pelo\xa0métodos\xa0HTTP, este filtro aceita como valores os métodos POST e GET. Ex.: POST;web_mime:\xa0Este filtro permite a\xa0seleção por\xa0MIME-Type, sendo exatamente este mesmo o valor aceito. Ex.:"application/octet-stream",\xa0ips_profile:\xa0Efetua a\xa0seleção pelo Perfil de Intrusion Prevention System, o valor aceito é o nome do perfil, para mais informações consulte esta página;app_name:\xa0Este filtro permite efetuar a\xa0seleção por nome do aplicativo. Ex.: Google APIs;app_category:\xa0Efetua a\xa0seleção pela categoria do aplicativo, sendo exatamente este mesmo o valor aceito. Ex.: web;malware_file:\xa0Faz a seleção nome do\xa0arquivo do\xa0malware. Ex.: malwarefile.com;malware_md5:\xa0Seleciona através do\xa0MD5\xa0dos\xa0malwares.\xa0Ex.: c69e30152b6aa805b23ba26ca1bfa866malware_status:\xa0Seleção pelo\xa0status\xa0dos\xa0malwares. Ex: INFECTED;malware_name:\xa0Seleção pelo\xa0nome\xa0dos\xa0malwares. Ex.: Malware;threat_class:\xa0Este filtro\xa0faz a seleção pela classe da ameaça. Ex.: Potentially Bad Traffic;threat_category:\xa0Efetua a\xa0seleção pela categoria da ameaça. Ex.: USER_AGENTS;threat_sid:\xa0Seleciona pelo SID da ameaça. Este filtro utiliza o SID da ameaça. Ex.: 2027916;threat_name:\xa0Estre filtro faz a seleção pelo nome da ameaça. Ex.: Poison Null Byte;threat_impact:\xa0Este filtro faz a seleção baseada no nível de impacto da ameaça. Ex.: High, Medium, Low;threat_dump:\xa0Seleção pelo dump da ameaça. Este filtro aceita o dump da ameaça;threat_payload:\xa0Faz a seleção pelo payload da ameaça. Esse filtro exige como value a sequência de payload da ameaça.flow: Mostra juntamente com o endereço IP, a NAT aplicada e qual o endereço atribuído.Contain/Not Contain:\xa0Esta caixa de seleção atua basicamente como um operador lógico do filtro da\xa0query;Contain:\xa0Irá exibir todos os resultados que contêm o valor do próximo campo (Value);Not Contain:\xa0Irá exibir todos os resultados que NÃO contêm o valor do próximo campo (Value).\xa0Equals:\xa0Irá exibir todos os resultados que são EXATAMENTE iguais ao que for adicionado no próximo campo (Value);Not Equals:\xa0Irá exibir todos os resultados que NÃO são iguais ao que for adicionado no próximo campo (Value);Value:\xa0Esta caixa determina o valor que será utilizado para filtrar a query,\xa0após definir o valor, clique em\xa0[] para adicionar a string no campo Filter string;Filter string:\xa0Após editar os campos anteriores, este campo exibirá\xa0a string\xa0que será utilizada pela busca. Além de usar as opções anteriores, é possível editar manualmente essa linha de código.Para limpar a query configurada, clique no botão Clear[]. Caso deseje cancelar clique no botão\xa0Cancel[]. Para efetuar uma busca utilizando a\xa0query clique no botão\xa0Search[].\xa0Para salvar a query, clique no botão Save Query\xa0[].Events - Query Editor - Load queryNa aba "Query Editor" é possível administrar as\xa0queries salvas,\xa0este painel é composto de uma\xa0barra de busca\xa0e um botão de ação com função de deletar todos os campos selecionados, a seguir analisaremos cada componente deste painel:Events - Query Editor - Load QuerySelect[]:\xa0Permite selecionar a query desejada;Name:\xa0Exibe o nome da query;Filter:\xa0Exibe a string utilizada pela busca;Actions:\xa0Exibe um conjunto de botões contextuais;Edit[]:\xa0Edita as configurações da query;Search[]:\xa0Efetua uma busca utilizando a query;Delete[]:\xa0Remove a query.\xa0Caso deseje cancelar clique no botão\xa0Cancel[]. Para efetuar uma busca utilizando a\xa0query\xa0selecionada clique no botão\xa0Search[].\xa0', '']
