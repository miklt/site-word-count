https://docs.blockbit.com/pages/viewpage.action?pageId=26819001
1192
['', 'High Availability - Configuração do Cluster Secundário', '']
['', 'Após ter feito as configurações no Cluster Primário,\xa0efetuaremos as seguintes configurações no Secundário:É necessário realizar o Wizard de Instalação da máquina secundária, conforme orientações desta página.Configuração das interfaces de heartbeat pois a comunicação com o IP do cluster primário precisa estar funcional para que o heartbeat seja efetivo;Configuração do cluster secundário.Configuração da InterfaceAcesse o menu Settings\xa0e clique em\xa0Network:Settings - NetworkClique na aba Interfaces:Aba Interfaces', 'Alguns detalhes da aba interfaces não serão considerados neste exemplo, caso deseje mais informações, consulte esta página.', 'Configure a sua rede conforme o necessário, neste exemplo usaremos a eth0:Configurações da eth0IP Address:\xa0O endereço IP utilizado pela interface. Seguindo a topologia, o IP será 172.31.207.82;Mask Address:\xa0A máscara utilizada por esse endereço IP;Enable []:\xa0Marque esta caixa de seleção para habilitar a interface.Clique em\xa0[] para finalizar as configurações:Além disso, configuraremos a eth1 para utilizar no heartbeat com o Cluster Primário.Configurações da eth1IP Address:\xa0O endereço IP utilizado pela interface, neste caso usaremos o IP 10.10.10.2;Mask Address:\xa0A máscara utilizada por esse endereço IP;Enable []:\xa0Marque esta caixa de seleção para habilitar a interface.Clique em\xa0[] para finalizar as configurações:O screenshot abaixo exibe as interfaces do\xa0Cluster Primário já configuradas e habilitadas corretamente:Network Settings - InterfacesÀ seguir trataremos das configurações de H.A. do cluster:Configurações de H.A.Acesse o menu Settings e clique na opção System:Settings - SystemClique na aba High Availability:Aba High AvailabilityA seguinte tela será exibida:System - High AvailabilityÀ seguir vamos detalhar os painéis que precisaremos configurar.Cluster SettingsComplete o formulário conforme exemplificado a seguir:High Availability - Cluster SettingsOperation Mode:\xa0Como este será o Cluster Secundário, selecione a opção "Secondary";Secret Key:\xa0Define a chave de seguarança para a relação de confiança entre os clusters, eles precisarão utilizar a mesma chave. Ex.:\xa0q1Q!q1Q!;Local Key:\xa0Para gerar um certificado para sincronismo de dados, clique no botão [];Peer Interface #1:\xa0Neste campo é adicionada a interface que será utilizada para efetuar o heartbeat com Cluster Primário, no caso usaremos a eth1;Peer IP #1:\xa0Neste campo é adicionado o IP da interface que efetuará heartbeat com o Cluster Primário, para tanto, usaremos o IP da eht1 do cluster\xa0Primário: 10.10.10.1;Peer Key:\xa0Neste campo deve-se colar o "Local Key" do Cluster Primário;Heartbeat Interval:\xa0Configuraremos o intervalo do heartbeat para 3 segundos;\xa0Sync Interval:\xa0Configuraremos o intervalo de sincronismo para 5 minutos;Failover threshold:\xa0Configuraremos o limite para 5 falhas;E-mail Notifications:\xa0Adicione o e-mail que será utilizado para receber as notificações do serviço de H.A., no caso usaremos: admin@blockbit.com;Auto Activation []:\xa0Por fim, iremos habilitar a auto-ativação para que o cluster seja ativado automaticamente em caso de falha.À seguir, iremos configurar os IPs virtuais.Cluster InterfacesComplete o formulário conforme exemplificado a seguir:High Availability - Cluster InterfacesETH0[]:\xa0Neste exemplo utilizaremos apenas a interface ETH0, portanto, habilite-a marcando a caixa de checagem;Virtual IP:\xa0Adicione a o IP virtual que o cluster irá assumir quando estiverem com prioridade,\xa0no exemplo utilizaremos o IP: 172.31.207.80;Netmask:\xa0Adicione a máscara do endereço IP, no caso: 255.255.0.0;Virtual Mac:\xa0O Mac Virtual é opcional, no caso iremos usá-lo para evitar conflitos na tabela ARP. No exemplo usaremos o MAC: 00:0c:29:f4:f1:ff.Ao finalizar todas as configurações, a tela estará como demonstrado abaixo:High Availability - Cluster SecundárioPara salvar, clique em\xa0[].Isso finaliza a configuração no cluster secundário, à seguir iremos validar as configurações.Após ter feito as configurações no Cluster Primário,\xa0efetuaremos as seguintes configurações no Secundário:Configuração das interfaces de heartbeat pois a comunicação com o IP do cluster primário precisa estar funcional para que o heartbeat seja efetivo;Configuração do cluster secundário.Configuração da InterfaceAcesse o menu Settings\xa0e clique em\xa0Network:Settings - NetworkClique na aba Interfaces:Aba Interfaces', 'Alguns detalhes da aba interfaces não serão considerados neste exemplo, caso deseje mais informações, consulte esta página.', 'Configure a sua rede conforme o necessário, neste exemplo usaremos a eth0:Configurações da eth0IP Address:\xa0O endereço IP utilizado pela interface. Seguindo a topologia, o IP será 172.31.207.82;Mask Address:\xa0A máscara utilizada por esse endereço IP;Enable []:\xa0Marque esta caixa de seleção para habilitar a interface.Clique em\xa0[] para finalizar as configurações:Além disso, configuraremos a eth1 para utilizar no heartbeat com o Cluster Primário.Configurações da eth1IP Address:\xa0O endereço IP utilizado pela interface, neste caso usaremos o IP 10.10.10.2;Mask Address:\xa0A máscara utilizada por esse endereço IP;Enable []:\xa0Marque esta caixa de seleção para habilitar a interface.Clique em\xa0[] para finalizar as configurações:O screenshot abaixo exibe as interfaces do\xa0Cluster Primário já configuradas e habilitadas corretamente:Network Settings - InterfacesÀ seguir trataremos das configurações de H.A. do cluster:Configurações de H.A.Acesse o menu Settings e clique na opção System:Settings - SystemClique na aba High Availability:Aba High AvailabilityA seguinte tela será exibida:System - High AvailabilityÀ seguir vamos detalhar os painéis que precisaremos configurar.Cluster SettingsComplete o formulário conforme exemplificado a seguir:High Availability - Cluster SettingsOperation Mode:\xa0Como este será o Cluster Secundário, selecione a opção "Secondary";Secret Key:\xa0Define a chave de seguarança para a relação de confiança entre os clusters, eles precisarão utilizar a mesma chave. Ex.:\xa0q1Q!q1Q!;Local Key:\xa0Para gerar um certificado para sincronismo de dados, clique no botão [];Peer Interface #1:\xa0Neste campo é adicionada a interface que será utilizada para efetuar o heartbeat com Cluster Primário, no caso usaremos a eth1;Peer IP #1:\xa0Neste campo é adicionado o IP da interface que efetuará heartbeat com o Cluster Primário, para tanto, usaremos o IP da eht1 do cluster\xa0Primário: 10.10.10.1;Peer Key:\xa0Neste campo deve-se colar o "Local Key" do Cluster Primário;Heartbeat Interval:\xa0Configuraremos o intervalo do heartbeat para 3 minutos;\xa0Sync Interval:\xa0Configuraremos o intervalo de sincronismo para 5 segundos;Failover threshold:\xa0Configuraremos o limite para 5 falhas;E-mail Notifications:\xa0Adicione o e-mail que será utilizado para receber as notificações do serviço de H.A., no caso usaremos: admin@blockbit.com;Auto Activation []:\xa0Por fim, iremos habilitar a auto-ativação para que o cluster seja ativado automaticamente em caso de falha.À seguir, iremos configurar os IPs virtuais.Cluster InterfacesComplete o formulário conforme exemplificado a seguir:High Availability - Cluster InterfacesETH0[]:\xa0Neste exemplo utilizaremos apenas a interface ETH0, portanto, habilite-a marcando a caixa de checagem;Virtual IP:\xa0Adicione a o IP virtual que o cluster irá assumir quando estiverem com prioridade,\xa0no exemplo utilizaremos o IP: 172.31.207.80;Netmask:\xa0Adicione a máscara do endereço IP, no caso: 255.255.0.0;Virtual Mac:\xa0O Mac Virtual é opcional, no caso iremos usá-lo para evitar conflitos na tabela ARP. No exemplo usaremos o MAC: 00:0c:29:f4:f1:ff.Ao finalizar todas as configurações, a tela estará como demonstrado abaixo:High Availability - Cluster SecundárioPara salvar, clique em\xa0[].Isso finaliza a configuração no cluster secundário, à seguir iremos validar as configurações.', '']
